name: Boundary Condition Generation

on:
  push:
  workflow_dispatch:

jobs:
  generate-boundary-conditions:
    runs-on: ubuntu-latest
    steps:

      # 1️⃣ Checkout Repository
      - name: Checkout Repository
        uses: actions/checkout@v3

      # 2️⃣ Install Dependencies (Fix Missing `pyvista`)
      - name: Install Python Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pyvista numpy meshio

      # 3️⃣ Verify `.obj` File Exists
      - name: Check `testing-Body.obj`
        run: ls -l ./testing-input-output/

      # 4️⃣ Run Boundary Conditions Script
      - name: Generate Boundary Conditions
        run: python boundary_conditions.py ./testing-input-output/testing-Body.obj

      # 5️⃣ Verify `boundary_conditions.json` Creation
      - name: Check Output
        run: ls -l ./testing-input-output/

      # 6️⃣ Commit and Push `boundary_conditions.json` to Repository
      - name: Commit and Push Boundary Conditions JSON
        env:
          GIT_USER_NAME: ${{ secrets.GIT_USER_NAME }}
          GIT_USER_EMAIL: ${{ secrets.GIT_USER_EMAIL }}
        run: |
          git config --global user.name "$GIT_USER_NAME"
          git config --global user.email "$GIT_USER_EMAIL"
          git add testing-input-output/boundary_conditions.json
          git commit -m "Auto-update: Added latest boundary conditions JSON file"
          git push origin HEAD



